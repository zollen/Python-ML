'''
Created on Jul. 3, 2021

@author: zollen
'''

import pandas as pd
import numpy as np
import warnings

warnings.filterwarnings('ignore')

pd.set_option('max_columns', None)
pd.set_option('max_rows', None)
pd.set_option('display.width', 1000)

test = pd.read_csv('../data/test.csv')
preds = pd.read_csv('../data/prediction.csv')
train = pd.read_csv('../data/sales_train.csv')

chk = pd.merge(test, preds, how='inner')

'''
          date_block_num  shop_id  item_id  item_price  item_cnt_month
1285607               33        7     4415      1500.0              -1
1901313               33       12     5488      2799.0              -1
1943337               33       12     9242      1500.0              -1
4184889               33       21    16146      1799.0              -1
5428473               33       25    21256      1299.0              -1
5589157               33       26    10513      1499.0              -1
5753479               33       26    21363      3199.0              -1
7844445               33       34     7233       599.0              -1
10933209              33       48     2860      1799.0              -1
10961973              33       48     6674     29990.0              -1
          date_block_num  shop_id  item_id  item_price  item_cnt_month
465662                32        4    10930       229.0              -1
660278                32        5     6738       999.0              -1
863598                32        6     2244       299.0              -1
1262180               32        7     2780      2199.0              -1
1842492               32       12      948       499.0              -1
1854902               32       12     1877      1799.0              -1
1866054               32       12     2808      1499.0              -1
1895464               32       12     5035       599.0              -1
1895532               32       12     5037      1299.0              -1
3687808               32       19     7805       497.5              -1
4393478               32       22     9255      1300.0              -1
5908416               32       27     9250      1300.0              -1
6429296               32       28    15575      7298.0              -1
9232324               32       42     5581       499.0              -1
9501400               32       42    19092       199.0              -1
10234236              32       45    13466      7498.0              -1
10453638              32       46     9001      5999.0              -1
10506644              32       46    12693      1499.0              -1
10941368              32       48     3708       899.0              -1
10982712              32       48    10382       199.0              -1
10997230              32       48    12935       299.0              -1
11113748              32       49     9089       229.0              -1
11166958              32       49    18439       229.0              -1
12075438              32       52    21760       499.0              -1
13288082              32       57     2780      2199.0              -1
13357000              32       57     6675     26990.0              -1

'''
kk = pd.read_csv('../data/monthly_train.csv')
print(kk[(kk['date_block_num'] == 33) & (kk['item_cnt_month'] < 0)])
print(kk[(kk['date_block_num'] == 32) & (kk['item_cnt_month'] < 0)])
exit()


res = chk.loc[chk['item_cnt_month'] < 0, ['shop_id', 'item_id', 'item_cnt_month']]


'''
140460       57    20274            -1
125160       52    20274            -1
162952       56    20958            -3
198652       41    20958            -3
157315       55     8516            -5
116338       49    21902            -2
213238       45    21902            -1
148054       59    10352            -1
151713       59    10230            -1
163135       56     9783            -2
152935       59     9783            -2
55138        26    21902            -2
142735       57     9783            -1
157314       55     8524            -2
147835       58     9783            -1
142954       58    10352            -1
'''
chk2 = set([
        (59, 10230), (26, 21902), (56, 20958), (58, 10352), (57, 20274),
        (41, 20958), (49, 21902), (57, 9783), (58, 9783), (59, 9783),
        (52, 20274), (56, 9783), (55, 8524), (45, 21902), (59, 10352),
        (55, 8516)
    ])


for shopId, itemId in chk2:
    print(train[(train['shop_id'] == shopId) & (train['item_id'] == itemId)])
    
